#!/usr/bin/env bash
# show a version string of the repo
vstr=`git describe 2> /dev/null`
vgit=`git rev-parse --short HEAD`
if [ "$1" == "--commit-only" ] ; then
  vstr="$vgit"
else
  case "$vstr" in
  v[0-9]*)
    git update-index -q --refresh 2> /dev/null
    test -z "`git diff-index --name-only HEAD -- 2>&1`" || vstr="$vstr.git.$vgit"
    ;;
  *) vstr="tarball"
  esac
fi

echo $vstr
